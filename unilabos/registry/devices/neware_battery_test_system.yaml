neware_battery_test_system:
  category:
  - neware_battery_test_system
  - neware
  - battery_test
  class:
    action_value_mappings:
      debug_resource_names:
        feedback: {}
        goal: {}
        goal_default: {}
        handles: {}
        result:
          return_info: return_info
          success: success
        schema:
          description: 调试方法：显示所有资源的实际名称
          properties:
            feedback: {}
            goal:
              properties: {}
              required: []
              type: object
            result:
              properties:
                return_info:
                  description: 资源调试信息
                  type: string
                success:
                  description: 是否成功
                  type: boolean
              required:
              - return_info
              - success
              type: object
          required:
          - goal
          type: object
        type: UniLabJsonCommand
      export_status_json:
        feedback: {}
        goal:
          filepath: filepath
        goal_default:
          filepath: bts_status.json
        handles: {}
        result:
          return_info: return_info
          success: success
        schema:
          description: 导出当前状态数据到JSON文件
          properties:
            feedback: {}
            goal:
              properties:
                filepath:
                  default: bts_status.json
                  description: 输出JSON文件路径
                  type: string
              required: []
              type: object
            result:
              properties:
                return_info:
                  description: 导出操作结果信息
                  type: string
                success:
                  description: 导出是否成功
                  type: boolean
              required:
              - return_info
              - success
              type: object
          required:
          - goal
          type: object
        type: UniLabJsonCommand
      get_device_summary:
        feedback: {}
        goal: {}
        goal_default: {}
        handles: {}
        result:
          return_info: return_info
          success: success
        schema:
          description: 获取设备级别的摘要统计信息
          properties:
            feedback: {}
            goal:
              properties: {}
              required: []
              type: object
            result:
              properties:
                return_info:
                  description: 设备摘要信息JSON格式
                  type: string
                success:
                  description: 查询是否成功
                  type: boolean
              required:
              - return_info
              - success
              type: object
          required:
          - goal
          type: object
        type: UniLabJsonCommand
      get_plate_status:
        feedback: {}
        goal:
          plate_num: plate_num
        goal_default:
          plate_num: null
        handles: {}
        result:
          plate_data: plate_data
          return_info: return_info
          success: success
        schema:
          description: 获取指定盘或所有盘的状态信息
          properties:
            feedback: {}
            goal:
              properties:
                plate_num:
                  description: 盘号 (1 或 2)，如果为null则返回所有盘的状态
                  maximum: 2
                  minimum: 1
                  type: integer
              required: []
              type: object
            result:
              properties:
                plate_data:
                  description: 盘状态数据（单盘或所有盘）
                  type: object
                return_info:
                  description: 操作结果信息
                  type: string
                success:
                  description: 查询是否成功
                  type: boolean
              required:
              - return_info
              - success
              - plate_data
              type: object
          required:
          - goal
          type: object
        type: UniLabJsonCommand
      print_status_summary_action:
        feedback: {}
        goal: {}
        goal_default: {}
        handles: {}
        result:
          return_info: return_info
          success: success
        schema:
          description: 打印通道状态摘要信息到控制台
          properties:
            feedback: {}
            goal:
              properties: {}
              required: []
              type: object
            result:
              properties:
                return_info:
                  description: 打印操作结果信息
                  type: string
                success:
                  description: 打印是否成功
                  type: boolean
              required:
              - return_info
              - success
              type: object
          required:
          - goal
          type: object
        type: UniLabJsonCommand
      query_plate_action:
        feedback: {}
        goal:
          string: plate_id
        goal_default:
          string: ''
        handles: {}
        result:
          return_info: return_info
          success: success
        schema:
          description: ''
          properties:
            feedback:
              properties: {}
              required: []
              title: StrSingleInput_Feedback
              type: object
            goal:
              properties:
                string:
                  type: string
              required:
              - string
              title: StrSingleInput_Goal
              type: object
            result:
              properties:
                return_info:
                  type: string
                success:
                  type: boolean
              required:
              - return_info
              - success
              title: StrSingleInput_Result
              type: object
          required:
          - goal
          title: StrSingleInput
          type: object
        type: StrSingleInput
      submit_from_csv:
        feedback: {}
        goal:
          csv_path: string
          output_dir: string
        goal_default:
          csv_path: ''
          output_dir: .
        handles: {}
        result:
          return_info: return_info
          submitted_count: submitted_count
          success: success
        schema:
          description: 从CSV文件批量提交Neware测试任务
          properties:
            feedback: {}
            goal:
              properties:
                csv_path:
                  description: 输入CSV文件的绝对路径
                  type: string
                output_dir:
                  description: 输出目录（用于存储XML和备份文件），默认当前目录
                  type: string
              required:
              - csv_path
              type: object
            result:
              properties:
                return_info:
                  description: 执行结果详细信息
                  type: string
                submitted_count:
                  description: 成功提交的任务数量
                  type: integer
                success:
                  description: 是否成功
                  type: boolean
                total_count:
                  description: CSV文件中的总行数
                  type: integer
              required:
              - return_info
              - success
              type: object
          required:
          - goal
          type: object
        type: UniLabJsonCommand
      test_connection_action:
        feedback: {}
        goal: {}
        goal_default: {}
        handles: {}
        result:
          return_info: return_info
          success: success
        schema:
          description: 测试与电池测试系统的TCP连接
          properties:
            feedback: {}
            goal:
              properties: {}
              required: []
              type: object
            result:
              properties:
                return_info:
                  description: 连接测试结果信息
                  type: string
                success:
                  description: 连接测试是否成功
                  type: boolean
              required:
              - return_info
              - success
              type: object
          required:
          - goal
          type: object
        type: UniLabJsonCommand
      upload_backup_to_oss:
        feedback: {}
        goal:
          backup_dir: backup_dir
          file_pattern: file_pattern
          oss_prefix: oss_prefix
        goal_default:
          backup_dir: null
          file_pattern: '*'
          oss_prefix: null
        handles:
          output:
          - data_key: uploaded_files
            data_source: executor
            data_type: array
            handler_key: uploaded_files
            io_type: sink
            label: Uploaded Files (with standard flow info)
        result:
          failed_files: failed_files
          return_info: return_info
          success: success
          total_count: total_count
          uploaded_count: uploaded_count
        schema:
          description: 上传备份文件到阿里云OSS
          properties:
            feedback: {}
            goal:
              properties:
                backup_dir:
                  description: 备份目录路径（默认使用最近一次submit_from_csv的backup_dir）
                  type: string
                file_pattern:
                  default: '*'
                  description: 文件通配符模式，例如 *.csv 或 Battery_*.nda
                  type: string
                oss_prefix:
                  description: OSS对象路径前缀（默认使用self.oss_prefix）
                  type: string
              required: []
              type: object
            result:
              properties:
                failed_files:
                  description: 上传失败的文件名列表
                  items:
                    type: string
                  type: array
                return_info:
                  description: 上传操作结果信息
                  type: string
                success:
                  description: 上传是否成功
                  type: boolean
                total_count:
                  description: 总文件数
                  type: integer
                uploaded_count:
                  description: 成功上传的文件数
                  type: integer
                uploaded_files:
                  description: 成功上传的文件详情列表
                  items:
                    properties:
                      Battery_Code:
                        description: 电池编码
                        type: string
                      Electrolyte_Code:
                        description: 电解液编码
                        type: string
                      filename:
                        description: 文件名
                        type: string
                      url:
                        description: OSS下载链接
                        type: string
                    required:
                    - filename
                    - url
                    - Battery_Code
                    - Electrolyte_Code
                    type: object
                  type: array
              required:
              - return_info
              - success
              - uploaded_count
              - total_count
              - failed_files
              - uploaded_files
              type: object
          required:
          - goal
          type: object
        type: UniLabJsonCommand
    module: unilabos.devices.neware_battery_test_system.neware_battery_test_system:NewareBatteryTestSystem
    status_types:
      channel_status: dict
      connection_info: dict
      status: str
      total_channels: int
    type: python
  config_info: []
  description: 新威电池测试系统驱动，提供720个通道的电池测试状态监控、物料管理和CSV批量提交功能。支持TCP通信实现远程控制，包含完整的物料管理系统（2盘电池状态映射），以及从CSV文件批量提交测试任务的能力。
  handles: []
  icon: ''
  init_param_schema:
    config:
      properties:
        devtype:
          default: '27'
          type: string
        ip:
          default: 127.0.0.1
          type: string
        machine_id:
          default: 1
          type: integer
        oss_prefix:
          default: neware_backup
          description: OSS对象路径前缀
          type: string
        oss_upload_enabled:
          default: false
          description: 是否启用OSS上传功能
          type: boolean
        port:
          default: 502
          type: integer
        size_x:
          default: 500.0
          type: number
        size_y:
          default: 500.0
          type: number
        size_z:
          default: 2000.0
          type: number
        timeout:
          default: 20
          type: integer
      required: []
      type: object
    data:
      properties:
        channel_status:
          type: object
        connection_info:
          type: object
        device_summary:
          type: object
        status:
          type: string
        total_channels:
          type: integer
      required:
      - status
      - channel_status
      - connection_info
      - total_channels
      - device_summary
      type: object
  version: 1.0.0
